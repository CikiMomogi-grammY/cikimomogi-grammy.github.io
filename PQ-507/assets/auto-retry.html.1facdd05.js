import{_ as p,r as a,o as d,c as m,b as s,a as e,w as t,d as n,e as i}from"./app.9837a88d.js";const b={},g=e("h1",{id:"reintentar-solicitudes-de-la-api-auto-retry",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#reintentar-solicitudes-de-la-api-auto-retry","aria-hidden":"true"},"#"),n(" Reintentar solicitudes de la API ("),e("code",null,[n("auto"),e("wbr"),n("-retry")]),n(")")],-1),_=n("Considera usar el "),k=n("plugin throttler"),h=n(" en su lugar."),f=n("Este plugin es una "),y=n("funci\xF3n transformadora de la API"),v=n(", lo que significa que le permite interceptar y modificar las peticiones HTTP salientes sobre la marcha. M\xE1s concretamente, este plugin detectar\xE1 autom\xE1ticamente si una petici\xF3n de la API falla con un valor "),w=e("code",null,[n("retry"),e("wbr"),n("_after")],-1),x=n(", es decir, debido a la limitaci\xF3n de velocidad. Entonces atrapar\xE1 el error, esperar\xE1 el per\xEDodo de tiempo especificado, y luego reintentar\xE1 la solicitud."),j=i('<div class="custom-container warning"><p class="custom-container-title">Sea amable con el servidor de la API del bot</p><p>Telegram proporciona generosamente informaci\xF3n sobre cu\xE1nto tiempo debe esperar tu bot antes de la siguiente solicitud. Usar el plugin <code>auto<wbr>-retry</code> permitir\xE1 a tu bot rendir mejor durante los picos de carga, ya que las peticiones no fallar\xE1n simplemente por el l\xEDmite de inundaci\xF3n. Sin embargo, <strong>auto-retry no deber\xEDa ser usado</strong> si quieres evitar golpear los l\xEDmites de velocidad de forma regular. Si regularmente cruzas el umbral de la cantidad de solicitudes que puedes realizar, Telegram puede tomar medidas como restringir o prohibir tu bot.</p></div><p>Puedes instalar este plugin en el objeto <code>bot<wbr>.api</code>:</p>',2),R=e("div",{class:"language-typescript ext-ts line-numbers-mode"},[e("pre",{class:"language-typescript"},[e("code",null,[e("span",{class:"token keyword"},"import"),n(),e("span",{class:"token punctuation"},"{"),n(" autoRetry "),e("span",{class:"token punctuation"},"}"),n(),e("span",{class:"token keyword"},"from"),n(),e("span",{class:"token string"},'"@grammyjs/auto-retry"'),e("span",{class:"token punctuation"},";"),n(`

`),e("span",{class:"token comment"},"// Usa el plugin."),n(`
bot`),e("span",{class:"token punctuation"},"."),n("api"),e("span",{class:"token punctuation"},"."),n("config"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"use"),e("span",{class:"token punctuation"},"("),e("span",{class:"token function"},"autoRetry"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),n(`
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),T=e("div",{class:"language-javascript ext-js line-numbers-mode"},[e("pre",{class:"language-javascript"},[e("code",null,[e("span",{class:"token keyword"},"const"),n(),e("span",{class:"token punctuation"},"{"),n(" autoRetry "),e("span",{class:"token punctuation"},"}"),n(),e("span",{class:"token operator"},"="),n(),e("span",{class:"token function"},"require"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},'"@grammyjs/auto-retry"'),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),n(`

`),e("span",{class:"token comment"},"// Usa el plugin."),n(`
bot`),e("span",{class:"token punctuation"},"."),n("api"),e("span",{class:"token punctuation"},"."),n("config"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"use"),e("span",{class:"token punctuation"},"("),e("span",{class:"token function"},"autoRetry"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),n(`
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),E=e("div",{class:"language-typescript ext-ts line-numbers-mode"},[e("pre",{class:"language-typescript"},[e("code",null,[e("span",{class:"token keyword"},"import"),n(),e("span",{class:"token punctuation"},"{"),n(" autoRetry "),e("span",{class:"token punctuation"},"}"),n(),e("span",{class:"token keyword"},"from"),n(),e("span",{class:"token string"},'"https://esm.sh/@grammyjs/auto-retry"'),e("span",{class:"token punctuation"},";"),n(`

`),e("span",{class:"token comment"},"// Usa el plugin."),n(`
bot`),e("span",{class:"token punctuation"},"."),n("api"),e("span",{class:"token punctuation"},"."),n("config"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"use"),e("span",{class:"token punctuation"},"("),e("span",{class:"token function"},"autoRetry"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),n(`
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),I=i(`<p>Si ahora llama, por ejemplo, a <code>send<wbr>Message</code> y se encuentra con un l\xEDmite de velocidad, parecer\xE1 que la petici\xF3n tarda un tiempo inusual. Bajo el cap\xF3, se est\xE1n realizando m\xFAltiples peticiones HTTP, con los retrasos apropiados entre ellas.</p><p>Puede pasar un objeto de opciones que especifique un n\xFAmero m\xE1ximo de reintentos (<code>max<wbr>Retry<wbr>Attempts</code>, por defecto: 3), o un umbral para un tiempo m\xE1ximo de espera (<code>max<wbr>Delay<wbr>Seconds</code>, por defecto: 1 hora).</p><p>Tan pronto como se agote el n\xFAmero m\xE1ximo de reintentos, los siguientes errores para la misma petici\xF3n no se volver\xE1n a intentar. En su lugar, se pasa el objeto de error de Telegram, fallando efectivamente la petici\xF3n con un [<code>Grammy<wbr>Error</code>] (/guide/errors.md#the-grammyerror-object).</p><p>De forma similar, si la petici\xF3n falla con <code>retry<wbr>_after</code> mayor que lo especificado por la opci\xF3n <code>max<wbr>Delay<wbr>Seconds</code>, la petici\xF3n fallar\xE1 inmediatamente.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token function">autoRetry</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  maxRetryAttempts<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// S\xF3lo se repiten las peticiones una vez</span>
  maxDelaySeconds<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// Falla inmediatamente si tenemos que esperar &gt;5 segundos</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="resumen-del-plugin" tabindex="-1"><a class="header-anchor" href="#resumen-del-plugin" aria-hidden="true">#</a> Resumen del plugin</h2>`,6),q=e("li",null,[n("Nombre: "),e("code",null,[n("auto"),e("wbr"),n("-retry")])],-1),P=n("Fuente: "),A={href:"https://github.com/grammyjs/auto-retry",target:"_blank",rel:"noopener noreferrer"},S=n("https://"),D=e("wbr",null,null,-1),z=n("github"),C=e("wbr",null,null,-1),N=n(".com"),G=e("wbr",null,null,-1),L=n("/grammyjs"),F=e("wbr",null,null,-1),Y=n("/auto"),B=e("wbr",null,null,-1),H=n("-retry"),K=n("Reference: "),U={href:"https://doc.deno.land/https://raw.githubusercontent.com/grammyjs/auto-retry/main/src/index.ts",target:"_blank",rel:"noopener noreferrer"},V=i("https://<wbr>doc<wbr>.deno<wbr>.land<wbr>/https://<wbr>raw<wbr>.githubusercontent<wbr>.com<wbr>/grammyjs<wbr>/auto<wbr>-retry<wbr>/main<wbr>/src<wbr>/index<wbr>.ts",29);function M(O,J){const l=a("AutotagPage"),r=a("RouterLink"),o=a("CodeGroupItem"),u=a("CodeGroup"),c=a("ExternalLinkIcon");return d(),m("div",null,[g,s(l,{config:'[{"url":["/plugins"],"exclude":["console-time","middlewares","autoquote","guide","session","keyboard","/"],"tag":[{"template":"official","text":"OFFICIAL","desc":"This plugin is published and maintained by grammY","locale":{"es":{"text":"OFICIAL","desc":"Este plugin es publicado y mantenido por grammY"},"id":{"text":"RESMI","desc":"Plugin ini dipublikasi dan dikelola oleh grammY"},"zh":{"text":"\u5B98\u65B9\u7EF4\u62A4","desc":"\u8FD9\u4E2A\u63D2\u4EF6\u662F\u7531grammY\u53D1\u5E03\u548C\u7EF4\u62A4\u7684"}}}]},{"url":["/plugins"],"include":["console-time","middlewares","autoquote"],"tag":[{"template":"thirdparty","text":"THIRD-PARTY","desc":"This plugin is maintained by third-party","locale":{"es":{"text":"DE TERCEROS","desc":"Este plugin es mantenido por terceros"},"id":{"text":"PIHAK KETIGA","desc":"Plugin ini dikelola oleh pihak ketiga"},"zh":{"text":"\u7B2C\u4E09\u65B9","desc":"\u8FD9\u4E2A\u63D2\u4EF6\u662F\u7531\u7B2C\u4E09\u65B9\u7EF4\u62A4\u7684"}}}]},{"url":["/hosting"],"exclude":["gcf","comparison"],"tag":[{"template":"deno","desc":"This setup is able to run Deno bots","locale":{"es":{"desc":"Esta configuraci\xF3n es capaz de ejecutar bots Deno"},"id":{"desc":"Konfigurasi ini dapat dijalankan di bot Deno"},"zh":{"desc":"\u8FD9\u4E2A\u8BBE\u7F6E\u80FD\u591F\u8FD0\u884CDeno\u673A\u5668\u4EBA"}}}]},{"url":["/hosting"],"include":["heroku","vps"],"tag":[{"template":"nodejs","desc":"This setup is able to run Node.js bots","locale":{"es":{"desc":"Esta configuraci\xF3n es capaz de ejecutar bots Node.js"},"id":{"desc":"Konfigurasi ini dapat dijalankan di bot Node.js"},"zh":{"desc":"\u8FD9\u4E2A\u8BBE\u7F6E\u80FD\u591F\u8FD0\u884CNode.js\u673A\u5668\u4EBA"}}}]}]'}),e("blockquote",null,[e("p",null,[_,s(r,{to:"/es/plugins/transformer-throttler.html"},{default:t(()=>[k]),_:1}),h])]),e("p",null,[f,s(r,{to:"/es/advanced/transformers.html"},{default:t(()=>[y]),_:1}),v,w,x]),j,s(u,null,{default:t(()=>[s(o,{title:"TypeScript",active:""},{default:t(()=>[R]),_:1}),s(o,{title:"JavaScript"},{default:t(()=>[T]),_:1}),s(o,{title:"Deno"},{default:t(()=>[E]),_:1})]),_:1}),I,e("ul",null,[q,e("li",null,[P,e("a",A,[S,D,z,C,N,G,L,F,Y,B,H,s(c)])]),e("li",null,[K,e("a",U,[V,s(c)])])])])}const W=p(b,[["render",M],["__file","auto-retry.html.vue"]]);export{W as default};
