import{_ as r,r as t,o as d,c as k,b as s,a as n,w as e,d as a,e as l}from"./app.9a621f1c.js";const m={},g=n("h1",{id:"peningkatan-i-codebase-skala-besar",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#peningkatan-i-codebase-skala-besar","aria-hidden":"true"},"#"),a(" Peningkatan I: Codebase Skala Besar")],-1),b=n("p",null,"Ketika bot-mu terus berkembang dan semakin kompleks, kamu akan mengalami kesulitan dalam mengatur struktur codebase untuk aplikasimu. Umumnya, kamu bisa membagi codebase menjadi beberapa file.",-1),h=n("h2",{id:"solusi-yang-tersedia",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#solusi-yang-tersedia","aria-hidden":"true"},"#"),a(" Solusi yang Tersedia")],-1),_=a("grammY masih cukup muda dan belum menyediakan integrasi resmi "),y=n("em",null,"DI container",-1),v=a(". Ikuti "),x={href:"https://t.me/grammyjs_news",target:"_blank",rel:"noopener noreferrer"},w=a("@grammyjs"),f=n("wbr",null,null,-1),C=a("_news"),j=a(" untuk mendapatkan notifikasi ketika integrasi sudah tersedia."),M=n("p",null,"Perlu dicatat bahwa tidak ada satu solusi yang cocok untuk semua orang, sehingga kamu dapat dengan bebas mengatur struktur kode sesukamu. Berikut strategi yang sudah terbukti sesuai dalam penyusunan struktur kode.",-1),I=n("li",null,"Kelompokkan hal-hal yang saling berkaitan di dalam file yang sama (atau di direktori yang sama, tergantung dari seberapa besar kode kamu).",-1),T=n("li",null,"Buat sebuah instance bot terpusat yang menggabungkan semua middleware dengan cara memasangnya ke dalam bot.",-1),q=a("(Opsional) Filter update secara terpusat terlebih dahulu, lalu sebar update dengan cara yang sesuai. Untuk melakukannya, silahkan cek "),D=n("code",null,[a("bot"),n("wbr"),a(".route")],-1),N=a(" ("),E={href:"https://doc.deno.land/https://deno.land/x/grammy/mod.ts/~/Composer#route",target:"_blank",rel:"noopener noreferrer"},P=a("API Reference"),S=a(") atau bisa juga menggunakan "),A=a("plugin router"),Q=a("."),O=a("Contoh siap pakai yang mengimplementasikan strategi-strategi di atas bisa ditemukan di "),R={href:"https://github.com/grammyjs/examples/tree/main/scaling",target:"_blank",rel:"noopener noreferrer"},Y=a("Repositori Contoh Bot"),B=a("."),F=l(`<h2 id="contoh-struktur" tabindex="-1"><a class="header-anchor" href="#contoh-struktur" aria-hidden="true">#</a> Contoh Struktur</h2><p>Untuk bot sederhana yang menangani <em>TODO list</em>, kamu bisa menggunakan struktur berikut.</p><div class="language-asciiart ext-asciiart"><pre class="language-asciiart"><code>src/
\u251C\u2500\u2500 bot.ts
\u2514\u2500\u2500 todo/
    \u251C\u2500\u2500 item.ts
    \u2514\u2500\u2500 list.ts
</code></pre></div><p><code>item<wbr>.ts</code> hanya diperuntukkan untuk mendefinisikan hal-hal yang berhubungan dengan item-item TODO, kemudian bagian kode tersebut akan digunakan di <code>list<wbr>.ts</code>.</p><p>Di <code>list<wbr>.ts</code>, kamu bisa melakukan hal seperti berikut:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> lists <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Composer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Tambahkan beberapa handler di sini</span>
<span class="token comment">// yang fungsinya mengatur middleware kamu seperti biasanya.</span>
lists<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),K=a("Sebagai tambahan, kamu bisa menambahkan sebuah "),z=a("error boundary"),L=a(" untuk mengatasi semua error yang terjadi di dalam module-mu."),G=l(`<p>Sekarang, kamu bisa memasang module-nya di <code>bot<wbr>.ts</code> seperti ini:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> lists <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./todo/list&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> bot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bot</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;token&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>lists<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ... kamu bisa menambahkan beberapa module seperti \`todo\` di sini</span>

bot<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),U=a("Cara lainnya, kamu bisa menggunakan "),V=a("plugin router"),H=a(". Plugin ini juga bisa digunakan untuk menggabungkan modul-modul yang berbeda dengan menentukan middleware mana yang akan digunakan di awal."),J=n("p",null,"Yang perlu diingat adalah tidak ada satu cara mutlak untuk mengatur struktur bot kamu, karena masing-masing bot memiliki kasus yang berbeda. Seperti biasa, pilih cara yang menurutmu paling sesuai dan cocok untuk bot kamu, karena kamulah sebagai pencipta yang paham mengenai seluk-beluk dari bot kamu. \u{1F609}",-1),W=n("h2",{id:"type-definition-untuk-middleware-yang-telah-di-extract",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#type-definition-untuk-middleware-yang-telah-di-extract","aria-hidden":"true"},"#"),a(" Type Definition untuk Middleware yang Telah Di-extract")],-1),X=n("p",null,"Struktur di atas dapat bekerja dengan baik menggunakan sebuah composer. Tetapi, di situasi tertentu kamu mungkin ingin meng-extract sebuah handler ke dalam sebuah function, alih-alih membuat sebuah composer baru lalu menambahkan logika ke dalamnya. Untuk melakukannya, kamu perlu menambahkan type definition middleware yang sesuai ke handler terkait karena mereka tidak bisa lagi mengambilnya dari composer.",-1),Z=a("grammY meng-export type definition untuk semua "),$=n("strong",null,"type middleware yang telah dikerucutkan",-1),nn=a(", misalnya sebuah middleware yang bisa kamu tambahkan ke command handler. Selain itu, ia juga meng-export type definition beberapa "),an=n("strong",null,"context object yang telah dikerucutkan",-1),sn=a(" yang digunakan di middleware tersebut. Kedua type tersebut parameternya ditulis ulang dengan "),en=a("custom context object"),tn=a(" kamu. Oleh karena itu, command handler akan memiliki type "),on=n("code",null,[a("Command"),n("wbr"),a("Middleware<My"),n("wbr"),a("Context>")],-1),cn=a(" serta "),ln=n("code",null,[a("Command"),n("wbr"),a("Context<My"),n("wbr"),a("Context>")],-1),un=a(" di context objectnya. Mereka bisa digunakan dengan cara seperti ini:"),pn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),a(),n("span",{class:"token punctuation"},"{"),a(`
  `),n("span",{class:"token keyword"},"type"),a(),n("span",{class:"token class-name"},"CallbackQueryMiddleware"),n("span",{class:"token punctuation"},","),a(`
  `),n("span",{class:"token keyword"},"type"),a(),n("span",{class:"token class-name"},"CommandContext"),n("span",{class:"token punctuation"},","),a(`
  `),n("span",{class:"token keyword"},"type"),a(),n("span",{class:"token class-name"},"NextFunction"),n("span",{class:"token punctuation"},","),a(`
`),n("span",{class:"token punctuation"},"}"),a(),n("span",{class:"token keyword"},"from"),a(),n("span",{class:"token string"},'"grammy"'),n("span",{class:"token punctuation"},";"),a(`

`),n("span",{class:"token keyword"},"function"),a(),n("span",{class:"token function"},"commandMiddleware"),n("span",{class:"token punctuation"},"("),a("ctx"),n("span",{class:"token operator"},":"),a(" CommandContext"),n("span",{class:"token operator"},"<"),a("MyContext"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},","),a(" next"),n("span",{class:"token operator"},":"),a(" NextFunction"),n("span",{class:"token punctuation"},")"),a(),n("span",{class:"token punctuation"},"{"),a(`
  `),n("span",{class:"token comment"},"// menangani command handling"),a(`
`),n("span",{class:"token punctuation"},"}"),a(`
`),n("span",{class:"token keyword"},"const"),a(" callbackQueryMiddleware"),n("span",{class:"token operator"},":"),a(" CallbackQueryMiddleware"),n("span",{class:"token operator"},"<"),a("MyContext"),n("span",{class:"token operator"},">"),a(),n("span",{class:"token operator"},"="),a(),n("span",{class:"token punctuation"},"("),a("ctx"),n("span",{class:"token punctuation"},")"),a(),n("span",{class:"token operator"},"=>"),a(),n("span",{class:"token punctuation"},"{"),a(`
  `),n("span",{class:"token comment"},"// menangani callback query"),a(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),a(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"start"'),n("span",{class:"token punctuation"},","),a(),n("span",{class:"token string"},'"help"'),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),a(" commandMiddleware"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),a(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"callbackQuery"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"query-data"'),n("span",{class:"token punctuation"},","),a(" callbackQueryMiddleware"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),a(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),rn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),a(),n("span",{class:"token punctuation"},"{"),a(`
  `),n("span",{class:"token keyword"},"type"),a(),n("span",{class:"token class-name"},"CallbackQueryMiddleware"),n("span",{class:"token punctuation"},","),a(`
  `),n("span",{class:"token keyword"},"type"),a(),n("span",{class:"token class-name"},"CommandContext"),n("span",{class:"token punctuation"},","),a(`
  `),n("span",{class:"token keyword"},"type"),a(),n("span",{class:"token class-name"},"NextFunction"),n("span",{class:"token punctuation"},","),a(`
`),n("span",{class:"token punctuation"},"}"),a(),n("span",{class:"token keyword"},"from"),a(),n("span",{class:"token string"},'"https://deno.land/x/grammy@v1.11.1/mod.ts"'),n("span",{class:"token punctuation"},";"),a(`

`),n("span",{class:"token keyword"},"function"),a(),n("span",{class:"token function"},"commandMiddleware"),n("span",{class:"token punctuation"},"("),a("ctx"),n("span",{class:"token operator"},":"),a(" CommandContext"),n("span",{class:"token operator"},"<"),a("MyContext"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},","),a(" next"),n("span",{class:"token operator"},":"),a(" NextFunction"),n("span",{class:"token punctuation"},")"),a(),n("span",{class:"token punctuation"},"{"),a(`
  `),n("span",{class:"token comment"},"// menangani command handling"),a(`
`),n("span",{class:"token punctuation"},"}"),a(`
`),n("span",{class:"token keyword"},"const"),a(" callbackQueryMiddleware"),n("span",{class:"token operator"},":"),a(" CallbackQueryMiddleware"),n("span",{class:"token operator"},"<"),a("MyContext"),n("span",{class:"token operator"},">"),a(),n("span",{class:"token operator"},"="),a(),n("span",{class:"token punctuation"},"("),a("ctx"),n("span",{class:"token punctuation"},")"),a(),n("span",{class:"token operator"},"=>"),a(),n("span",{class:"token punctuation"},"{"),a(`
  `),n("span",{class:"token comment"},"// menangani callback query"),a(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),a(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"start"'),n("span",{class:"token punctuation"},","),a(),n("span",{class:"token string"},'"help"'),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),a(" commandMiddleware"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),a(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"callbackQuery"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"query-data"'),n("span",{class:"token punctuation"},","),a(" callbackQueryMiddleware"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),a(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),dn=a("Kunjungi "),kn={href:"https://doc.deno.land/https://deno.land/x/grammy/mod.ts#Type_Aliases",target:"_blank",rel:"noopener noreferrer"},mn=a("referensi API type aliases"),gn=a(" untuk melihat gambaran umum semua type aliases yang telah di-export oleh grammY.");function bn(hn,_n){const u=t("AutotagPage"),o=t("ExternalLinkIcon"),i=t("RouterLink"),c=t("CodeGroupItem"),p=t("CodeGroup");return d(),k("div",null,[g,s(u,{config:'[{"url":["/plugins"],"exclude":["console-time","middlewares","autoquote","guide","session","keyboard","/"],"tag":[{"template":"official","text":"OFFICIAL","desc":"This plugin is published and maintained by grammY","locale":{"es":{"text":"OFICIAL","desc":"Este plugin es publicado y mantenido por grammY"},"id":{"text":"RESMI","desc":"Plugin ini dipublikasi dan dikelola oleh grammY"},"zh":{"text":"\u5B98\u65B9\u7EF4\u62A4","desc":"\u8FD9\u4E2A\u63D2\u4EF6\u662F\u7531grammY\u53D1\u5E03\u548C\u7EF4\u62A4\u7684"}}}]},{"url":["/plugins"],"include":["console-time","middlewares","autoquote"],"tag":[{"template":"thirdparty","text":"THIRD-PARTY","desc":"This plugin is maintained by third-party","locale":{"es":{"text":"DE TERCEROS","desc":"Este plugin es mantenido por terceros"},"id":{"text":"PIHAK KETIGA","desc":"Plugin ini dikelola oleh pihak ketiga"},"zh":{"text":"\u7B2C\u4E09\u65B9","desc":"\u8FD9\u4E2A\u63D2\u4EF6\u662F\u7531\u7B2C\u4E09\u65B9\u7EF4\u62A4\u7684"}}}]},{"url":["/hosting"],"exclude":["gcf","comparison"],"tag":[{"template":"deno","desc":"This setup is able to run Deno bots","locale":{"es":{"desc":"Esta configuraci\xF3n es capaz de ejecutar bots Deno"},"id":{"desc":"Konfigurasi ini dapat dijalankan di bot Deno"},"zh":{"desc":"\u8FD9\u4E2A\u8BBE\u7F6E\u80FD\u591F\u8FD0\u884CDeno\u673A\u5668\u4EBA"}}}]},{"url":["/hosting"],"include":["heroku","vps"],"tag":[{"template":"nodejs","desc":"This setup is able to run Node.js bots","locale":{"es":{"desc":"Esta configuraci\xF3n es capaz de ejecutar bots Node.js"},"id":{"desc":"Konfigurasi ini dapat dijalankan di bot Node.js"},"zh":{"desc":"\u8FD9\u4E2A\u8BBE\u7F6E\u80FD\u591F\u8FD0\u884CNode.js\u673A\u5668\u4EBA"}}}]}]'}),b,h,n("blockquote",null,[n("p",null,[_,y,v,n("a",x,[w,f,C,s(o)]),j])]),M,n("ol",null,[I,T,n("li",null,[q,D,N,n("a",E,[P,s(o)]),S,s(i,{to:"/id/plugins/router.html"},{default:e(()=>[A]),_:1}),Q])]),n("p",null,[O,n("a",R,[Y,s(o)]),B]),F,n("p",null,[K,s(i,{to:"/id/guide/errors.html#error-boundary"},{default:e(()=>[z]),_:1}),L]),G,n("p",null,[U,s(i,{to:"/id/plugins/router.html"},{default:e(()=>[V]),_:1}),H]),J,W,X,n("p",null,[Z,$,nn,an,sn,s(i,{to:"/id/guide/context.html#memodifikasi-object-context"},{default:e(()=>[en]),_:1}),tn,on,cn,ln,un]),s(p,null,{default:e(()=>[s(c,{title:"Node.js",active:""},{default:e(()=>[pn]),_:1}),s(c,{title:"Deno"},{default:e(()=>[rn]),_:1})]),_:1}),n("p",null,[dn,n("a",kn,[mn,s(o)]),gn])])}const vn=r(m,[["render",bn],["__file","structuring.html.vue"]]);export{vn as default};
