import{_ as r,r as i,o as d,c as k,b as a,a as n,w as e,d as s,e as c}from"./app.9a621f1c.js";const m={},b=n("h1",{id:"sesiones-y-almacenamiento-de-datos-incorporado",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#sesiones-y-almacenamiento-de-datos-incorporado","aria-hidden":"true"},"#"),s(" Sesiones y almacenamiento de datos (incorporado)")],-1),g=n("p",null,[s("Aunque siempre puedes escribir tu propio c\xF3digo para conectarte a un almacenamiento de datos de tu elecci\xF3n, grammY soporta un patr\xF3n de almacenamiento muy conveniente llamado "),n("em",null,"sessions"),s(".")],-1),h=n("blockquote",null,[n("p",null,[n("a",{href:"#c%C3%B3mo-usar-las-sesiones"},"Salta hacia abajo"),s(" si sabes c\xF3mo funcionan las sesiones.")])],-1),v=n("h2",{id:"\xBFpor-que-debemos-pensar-en-el-almacenamiento",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\xBFpor-que-debemos-pensar-en-el-almacenamiento","aria-hidden":"true"},"#"),s(" \xBFPor qu\xE9 debemos pensar en el almacenamiento?")],-1),_=s("A diferencia de las cuentas de usuarios regulares en Telegram, los bots tienen "),f={href:"https://core.telegram.org/bots#4-how-are-bots-different-from-humans",target:"_blank",rel:"noopener noreferrer"},y=s("almacenamiento limitado en la nube"),w=s(" en la nube de Telegram. Como resultado, hay algunas cosas que no puedes hacer con los bots:"),x=c(`<ol><li>No puedes acceder a los mensajes antiguos que recibi\xF3 tu bot.</li><li>No puedes acceder a los mensajes antiguos que tu bot envi\xF3.</li><li>No puedes obtener una lista de todos los chats con tu bot.</li><li>M\xE1s cosas, por ejemplo, no hay resumen de medios, etc.</li></ol><p>B\xE1sicamente, se reduce al hecho de que <strong>un bot s\xF3lo tiene acceso a la informaci\xF3n de la actualizaci\xF3n entrante en ese momento</strong> (por ejemplo, un mensaje), es decir, la informaci\xF3n que est\xE1 disponible en el objeto de contexto <code>ctx</code>.</p><p>En consecuencia, si <em>quieres acceder</em> a datos antiguos, tienes que almacenarlos en cuanto lleguen. Esto significa que debes tener un almacenamiento de datos, como un archivo, una base de datos o un almacenamiento en memoria.</p><p>Por supuesto, grammY te tiene cubierto aqu\xED: no tienes que alojar esto t\xFA mismo. Puedes utilizar el almacenamiento de sesiones de grammY, que no necesita ninguna configuraci\xF3n y es gratuito para siempre.</p><blockquote><p>Naturalmente, hay muchos otros servicios que ofrecen almacenamiento de datos como servicio, y grammY se integra perfectamente con ellos tambi\xE9n. Si quieres manejar tu propia base de datos, ten por seguro que grammY lo soporta igualmente bien. <a href="#adaptadores-de-almacenamiento-conocidos">Despl\xE1zate hacia abajo</a> para ver qu\xE9 integraciones est\xE1n actualmente disponibles.</p></blockquote><h2 id="\xBFque-son-las-sesiones" tabindex="-1"><a class="header-anchor" href="#\xBFque-son-las-sesiones" aria-hidden="true">#</a> \xBFQu\xE9 son las sesiones?</h2><p>Es muy com\xFAn que los bots almacenen alg\xFAn dato por chat. Por ejemplo, digamos que queremos construir un bot que cuente el n\xFAmero de veces que un mensaje contiene el emoji de la pizza \u{1F355} en su texto. Este bot podr\xEDa a\xF1adirse a un grupo, y podr\xEDa decir cu\xE1nto os gusta la pizza a ti y a tus amigos.</p><p>Cuando nuestro bot de pizza recibe un mensaje, tiene que recordar cu\xE1ntas veces ha visto una \u{1F355} en ese chat antes. Su recuento de pizzas no deber\xEDa cambiar, por supuesto, cuando su hermana a\xF1ada el bot de pizzas a su chat de grupo, as\xED que lo que realmente queremos es almacenar <em>un contador por chat</em>.</p><p>Las sesiones son una forma elegante de almacenar datos <em>por chat</em>. Utilizar\xEDas el identificador del chat como clave en tu base de datos, y un contador como valor. En este caso, llamar\xEDamos al identificador del chat la <em>clave de la sesi\xF3n</em>. (Puedes leer m\xE1s sobre las claves de sesi\xF3n <a href="#claves-de-sesion">aqu\xED abajo</a>. Efectivamente, tu bot almacenar\xE1 un mapa desde un identificador de chat a unos datos de sesi\xF3n personalizados, es decir, algo as\xED:</p><div class="language-json ext-json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;424242&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;pizzaCount&quot;</span><span class="token operator">:</span> <span class="token number">24</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;987654&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;pizzaCount&quot;</span><span class="token operator">:</span> <span class="token number">1729</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Cuando decimos base de datos, en realidad nos referimos a cualquier soluci\xF3n de almacenamiento de datos. Esto incluye archivos, almacenamiento en la nube o cualquier otra cosa. Bien, pero \xBFqu\xE9 son las sesiones ahora?</p></blockquote><p>Podemos instalar un middleware en el bot que proporcionar\xE1 los datos de la sesi\xF3n del chat en <code>ctx<wbr>.session</code> para cada actualizaci\xF3n. El plugin instalado har\xE1 algo antes y despu\xE9s de que nuestros manejadores sean llamados:</p><ol><li><strong>Antes de nuestro middleware.</strong> El plugin de sesi\xF3n carga los datos de sesi\xF3n del chat actual desde la base de datos. Almacena los datos en el objeto de contexto bajo <code>ctx<wbr>.session</code>.</li><li><strong>Nuestro middleware se ejecuta.</strong> Podemos <em>leer</em> <code>ctx<wbr>.session</code> para inspeccionar qu\xE9 valor estaba en la base de datos. Por ejemplo, si se env\xEDa un mensaje al chat con el identificador <code>424242</code>, ser\xEDa <code>ctx<wbr>.session <wbr>=<wbr> { pizza<wbr>Count:<wbr> 24 }</code> mientras se ejecuta nuestro middleware (al menos con el estado de la base de datos de ejemplo anterior). Tambi\xE9n podemos <em>modificar</em> <code>ctx<wbr>.session</code> arbitrariamente, por lo que podemos a\xF1adir, eliminar y cambiar campos a nuestro gusto.</li><li><strong>Despu\xE9s de nuestro middleware.</strong> El middleware de sesi\xF3n se asegura de que los datos se escriban de nuevo en la base de datos. Cualquiera que sea el valor de <code>ctx<wbr>.session</code> despu\xE9s de que el middleware termine de ejecutarse, se guardar\xE1 en la base de datos.</li></ol><p>Como resultado, ya no tenemos que preocuparnos de comunicarnos con el almacenamiento de datos. Simplemente modificamos los datos en <code>ctx<wbr>.session</code>, y el plugin se encargar\xE1 del resto.</p><h2 id="cuando-usar-las-sesiones" tabindex="-1"><a class="header-anchor" href="#cuando-usar-las-sesiones" aria-hidden="true">#</a> Cu\xE1ndo usar las sesiones</h2><blockquote><p><a href="#como-usar-las-sesiones">S\xE1ltate el paso</a> si ya sabes que quieres usar sesiones. Puedes pensar, esto es genial, \xA1nunca m\xE1s tendr\xE9 que preocuparme por las bases de datos! Y tienes raz\xF3n, las sesiones son una soluci\xF3n ideal, pero s\xF3lo para algunos tipos de datos.</p></blockquote><p>Seg\xFAn nuestra experiencia, hay casos de uso en los que las sesiones realmente brillan. Por otro lado, hay casos en los que una base de datos tradicional puede ser m\xE1s adecuada.</p><p>Esta comparaci\xF3n puede ayudarte a decidir si utilizar las sesiones o no.</p><table><thead><tr><th></th><th>Sesiones</th><th>Base de datos</th></tr></thead><tbody><tr><td><em>Acceso</em></td><td>un almacenamiento aislado <strong>por chat</strong></td><td>accede a los mismos datos desde <strong>m\xFAltiples chats</strong></td></tr><tr><td><em>Compartir</em></td><td>los datos son <strong>s\xF3lo utilizados por el bot</strong></td><td>los datos son <strong>utilizados por otros sistemas</strong> (por ejemplo, un servidor web conectado)</td></tr><tr><td><em>Formato</em></td><td>cualquier objeto JavaScript: cadenas, n\xFAmeros, matrices, etc.</td><td>cualquier dato (binario, archivos, estructurado, etc)</td></tr><tr><td><em>Tama\xF1o por chat</em></td><td>preferiblemente menos de ~3 MB por chat</td><td>cualquier tama\xF1o</td></tr><tr><td><em>Caracter\xEDstica exclusiva</em></td><td>Requerida por algunos plugins de grammY.</td><td>Soporta transacciones de base de datos.</td></tr></tbody></table><p>Esto no significa que las cosas <em>no puedan funcionar</em> si eliges sesiones/bases de datos por encima de las otras.</p><p>Por ejemplo, por supuesto que puedes almacenar grandes datos binarios en tu sesi\xF3n. Sin embargo, tu bot no funcionar\xEDa tan bien como podr\xEDa hacerlo de otro modo, por lo que recomendamos usar sesiones s\xF3lo cuando tengan sentido.</p><h2 id="como-usar-las-sesiones" tabindex="-1"><a class="header-anchor" href="#como-usar-las-sesiones" aria-hidden="true">#</a> C\xF3mo usar las sesiones</h2><p>Puedes a\xF1adir soporte de sesi\xF3n a grammY utilizando el middleware de sesi\xF3n incorporado.</p><h3 id="ejemplo-de-uso" tabindex="-1"><a class="header-anchor" href="#ejemplo-de-uso" aria-hidden="true">#</a> Ejemplo de uso</h3><p>Aqu\xED hay un ejemplo de bot que cuenta los mensajes que contienen un emoji de pizza \u{1F355}:</p>`,25),q=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" Bot"),n("span",{class:"token punctuation"},","),s(" Context"),n("span",{class:"token punctuation"},","),s(" session"),n("span",{class:"token punctuation"},","),s(" SessionFlavor "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"grammy"'),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Definir la forma de nuestra sesi\xF3n."),s(`
`),n("span",{class:"token keyword"},"interface"),s(),n("span",{class:"token class-name"},"SessionData"),s(),n("span",{class:"token punctuation"},"{"),s(`
  pizzaCount`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token builtin"},"number"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// Tipo de flavor context para incluir las sesiones."),s(`
`),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"MyContext"),s(),n("span",{class:"token operator"},"="),s(" Context "),n("span",{class:"token operator"},"&"),s(" SessionFlavor"),n("span",{class:"token operator"},"<"),s("SessionData"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"const"),s(" bot "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},[s("Bot"),n("span",{class:"token operator"},"<"),s("MyContext"),n("span",{class:"token operator"},">")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Instalar el middleware de sesi\xF3n, y definir el valor inicial de la sesi\xF3n."),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"initial"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s(" SessionData "),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"{"),s(" pizzaCount"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"0"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" initial "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"hunger"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" count "),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("pizzaCount"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"\xA1Tu nivel de hambre es "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("count"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},"!"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"hears"),n("span",{class:"token punctuation"},"("),n("span",{class:"token regex"},[n("span",{class:"token regex-delimiter"},"/"),n("span",{class:"token regex-source language-regex"},".*\u{1F355}.*"),n("span",{class:"token regex-delimiter"},"/")]),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("pizzaCount"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"start"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),j=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" Bot"),n("span",{class:"token punctuation"},","),s(" session "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"grammy"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"const"),s(" bot "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Bot"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Instalar el middleware de sesi\xF3n, y definir el valor inicial de la sesi\xF3n."),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"initial"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"pizzaCount"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"0"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" initial "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"hunger"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" count "),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("pizzaCount"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"\xA1Tu nivel de hambre es "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("count"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},"!"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"hears"),n("span",{class:"token punctuation"},"("),n("span",{class:"token regex"},[n("span",{class:"token regex-delimiter"},"/"),n("span",{class:"token regex-source language-regex"},".*\u{1F355}.*"),n("span",{class:"token regex-delimiter"},"/")]),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("pizzaCount"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"start"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),z=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(`
  Bot`),n("span",{class:"token punctuation"},","),s(`
  Context`),n("span",{class:"token punctuation"},","),s(`
  session`),n("span",{class:"token punctuation"},","),s(`
  SessionFlavor`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"https://deno.land/x/grammy@v1.11.1/mod.ts"'),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Definir la forma de nuestra sesi\xF3n."),s(`
`),n("span",{class:"token keyword"},"interface"),s(),n("span",{class:"token class-name"},"SessionData"),s(),n("span",{class:"token punctuation"},"{"),s(`
  pizzaCount`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token builtin"},"number"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// Tipo de flavor context para incluir las sesiones."),s(`
`),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"MyContext"),s(),n("span",{class:"token operator"},"="),s(" Context "),n("span",{class:"token operator"},"&"),s(" SessionFlavor"),n("span",{class:"token operator"},"<"),s("SessionData"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"const"),s(" bot "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},[s("Bot"),n("span",{class:"token operator"},"<"),s("MyContext"),n("span",{class:"token operator"},">")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Instalar el middleware de sesi\xF3n, y definir el valor inicial de la sesi\xF3n."),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"initial"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s(" SessionData "),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"{"),s(" pizzaCount"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"0"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" initial "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"command"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"hunger"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" count "),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("pizzaCount"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"\xA1Tu nivel de hambre es "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("count"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},"!"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"hears"),n("span",{class:"token punctuation"},"("),n("span",{class:"token regex"},[n("span",{class:"token regex-delimiter"},"/"),n("span",{class:"token regex-source language-regex"},".*\u{1F355}.*"),n("span",{class:"token regex-delimiter"},"/")]),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("pizzaCount"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"start"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),S=s("N\xF3tese que tambi\xE9n tenemos que "),C=s("ajustar el tipo de contexto"),E=s(" para que la sesi\xF3n est\xE9 disponible en \xE9l. El context flavor se llama "),D=n("code",null,[s("Session"),n("wbr"),s("Flavor")],-1),P=s("."),A=c(`<h3 id="datos-de-la-sesion-inicial" tabindex="-1"><a class="header-anchor" href="#datos-de-la-sesion-inicial" aria-hidden="true">#</a> Datos de la sesi\xF3n inicial</h3><p>Cuando un usuario contacta por primera vez con tu bot, no hay datos de sesi\xF3n disponibles para \xE9l. Por lo tanto, es importante que especifiques la opci\xF3n <code>initial</code> para el middleware de sesi\xF3n. Pasa una funci\xF3n que genere un nuevo objeto con datos de sesi\xF3n iniciales para los nuevos chats.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// Crea un nuevo objeto que se utilizar\xE1 como datos iniciales de la sesi\xF3n.</span>
<span class="token keyword">function</span> <span class="token function">createInitialSessionData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    pizzaCount<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token comment">// m\xE1s datos aqu\xED</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span> initial<span class="token operator">:</span> createInitialSessionData <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Lo mismo pero mucho m\xE1s corto:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token function-variable function">initial</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> pizzaCount<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="custom-container warning"><p class="custom-container-title">Compartir objetos</p><p>Aseg\xFArate de crear siempre un <em>objeto nuevo</em>. No <strong>haga esto</strong>:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// PELIGRO, MAL, INCORRECTO, PARAR</span>
<span class="token keyword">const</span> initialData <span class="token operator">=</span> <span class="token punctuation">{</span> pizzaCount<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// NO</span>
bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span> initial<span class="token operator">:</span> <span class="token punctuation">{</span> pizzaCount<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// EL MAL</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Si se hiciera esto, varios chats podr\xEDan compartir el mismo objeto de sesi\xF3n en la memoria. Por lo tanto, cambiar los datos de la sesi\xF3n en un chat puede afectar accidentalmente a los datos de la sesi\xF3n en el otro chat.</p></div><p>Tambi\xE9n puede omitir la opci\xF3n <code>initial</code> por completo, aunque se aconseja no hacerlo. Si no la especifica, la lectura de <code>ctx<wbr>.session</code> arrojar\xE1 un error para los nuevos usuarios.</p><h3 id="claves-de-sesion" tabindex="-1"><a class="header-anchor" href="#claves-de-sesion" aria-hidden="true">#</a> Claves de sesi\xF3n</h3><blockquote><p>Esta secci\xF3n describe una caracter\xEDstica avanzada de la que la mayor\xEDa de la gente no tiene que preocuparse. Es posible que desee continuar con la secci\xF3n sobre <a href="#almacenamiento-de-sus-datos">almacenamiento de sus datos</a>.</p></blockquote>`,9),T=s("Puedes especificar qu\xE9 clave de sesi\xF3n usar pasando una funci\xF3n llamada "),L=n("code",null,[s("get"),n("wbr"),s("Session"),n("wbr"),s("Key")],-1),M=s(" a las "),N={href:"https://doc.deno.land/https://deno.land/x/grammy/mod.ts/~/SessionOptions#getSessionKey",target:"_blank",rel:"noopener noreferrer"},B=s("opciones"),F=s(". De esta manera, puedes cambiar fundamentalmente el funcionamiento del plugin de sesi\xF3n. Por defecto, los datos se almacenan por chat. El uso de "),I=n("code",null,[s("get"),n("wbr"),s("Session"),n("wbr"),s("Key")],-1),R=s(" le permite almacenar los datos por usuario, o por combinaci\xF3n de usuario-chat, o como usted quiera. Aqu\xED hay tres ejemplos:"),Y=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token comment"},"// Almacena los datos por chat (por defecto)."),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"getSessionKey"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token operator"},":"),s(" Context"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token builtin"},"string"),s(),n("span",{class:"token operator"},"|"),s(),n("span",{class:"token keyword"},"undefined"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Permite que todos los usuarios de un chat grupal compartan la misma sesi\xF3n,"),s(`
  `),n("span",{class:"token comment"},"// pero dar una privada independiente a cada usuario en los chats privados"),s(`
  `),n("span",{class:"token keyword"},"return"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("chat"),n("span",{class:"token operator"},"?."),s("id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// Almacena los datos por usuario."),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"getSessionKey"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token operator"},":"),s(" Context"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token builtin"},"string"),s(),n("span",{class:"token operator"},"|"),s(),n("span",{class:"token keyword"},"undefined"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Da a cada usuario su almacenamiento de sesi\xF3n personal"),s(`
  `),n("span",{class:"token comment"},"// (se compartir\xE1 en los grupos y en su chat privado)"),s(`
  `),n("span",{class:"token keyword"},"return"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("from"),n("span",{class:"token operator"},"?."),s("id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// Almacena los datos por combinaci\xF3n usuario-chat."),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"getSessionKey"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token operator"},":"),s(" Context"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token builtin"},"string"),s(),n("span",{class:"token operator"},"|"),s(),n("span",{class:"token keyword"},"undefined"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Dar a cada usuario su almacenamiento de una sesi\xF3n personal por chat con el bot"),s(`
  `),n("span",{class:"token comment"},"// (una sesi\xF3n independiente para cada grupo y su chat privado)"),s(`
  `),n("span",{class:"token keyword"},"return"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("from "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token keyword"},"undefined"),s(),n("span",{class:"token operator"},"||"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("chat "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token keyword"},"undefined"),s(`
    `),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token keyword"},"undefined"),s(`
    `),n("span",{class:"token operator"},":"),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("ctx"),n("span",{class:"token punctuation"},"."),s("from"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},"/"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("ctx"),n("span",{class:"token punctuation"},"."),s("chat"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" getSessionKey "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),K=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// Almacena los datos por chat (por defecto)."),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"getSessionKey"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Permite que todos los usuarios de un chat grupal compartan la misma sesi\xF3n,"),s(`
  `),n("span",{class:"token comment"},"// pero dar una privada independiente a cada usuario en los chats privados"),s(`
  `),n("span",{class:"token keyword"},"return"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("chat"),n("span",{class:"token operator"},"?."),s("id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// Almacena los datos por usuario."),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"getSessionKey"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Da a cada usuario su almacenamiento de sesi\xF3n personal"),s(`
  `),n("span",{class:"token comment"},"// (se compartir\xE1 en los grupos y en su chat privado)"),s(`
  `),n("span",{class:"token keyword"},"return"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("from"),n("span",{class:"token operator"},"?."),s("id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// Almacena los datos por combinaci\xF3n usuario-chat."),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"getSessionKey"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// Dar a cada usuario su almacenamiento de una sesi\xF3n personal por chat con el bot"),s(`
  `),n("span",{class:"token comment"},"// (una sesi\xF3n independiente para cada grupo y su chat privado)"),s(`
  `),n("span",{class:"token keyword"},"return"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("from "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token keyword"},"undefined"),s(),n("span",{class:"token operator"},"||"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("chat "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token keyword"},"undefined"),s(`
    `),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token keyword"},"undefined"),s(`
    `),n("span",{class:"token operator"},":"),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("ctx"),n("span",{class:"token punctuation"},"."),s("from"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},"/"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("ctx"),n("span",{class:"token punctuation"},"."),s("chat"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" getSessionKey "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),$=c("<p>Siempre que <code>get<wbr>Session<wbr>Key</code> devuelva <code>undefined</code>, <code>ctx<wbr>.session</code> estar\xE1 <code>undefined</code>. Por ejemplo, el resolvedor de claves de sesi\xF3n por defecto no funcionar\xE1 para las actualizaciones de <code>poll</code>/<code>poll<wbr>_answer</code> o <code>inline<wbr>_query</code> porque no pertenecen a un chat (<code>ctx<wbr>.chat</code> est\xE1 <code>undefined</code>).</p>",1),O={class:"custom-container warning"},G=n("p",{class:"custom-container-title"},"Claves de sesi\xF3n y Webhooks",-1),U=n("p",null,[s("Cuando est\xE9s ejecutando tu bot con webhooks, deber\xEDas evitar usar la opci\xF3n "),n("code",null,[s("get"),n("wbr"),s("Session"),n("wbr"),s("Key")]),s(". Telegram env\xEDa los webhooks secuencialmente por chat, por lo que la resoluci\xF3n de la clave de sesi\xF3n por defecto es la \xFAnica implementaci\xF3n que garantiza no causar p\xE9rdida de datos.")],-1),J=s("Si debes usar la opci\xF3n (que por supuesto sigue siendo posible), debes saber lo que est\xE1s haciendo. Aseg\xFArese de entender las consecuencias de esta configuraci\xF3n leyendo el art\xEDculo "),V=s("este"),H=s(" y especialmente "),Q=s("este"),W=s("."),X=c(`<h3 id="almacenamiento-de-sus-datos" tabindex="-1"><a class="header-anchor" href="#almacenamiento-de-sus-datos" aria-hidden="true">#</a> Almacenamiento de sus datos</h3><p>En todos los ejemplos anteriores, los datos de la sesi\xF3n se almacenan en su memoria RAM, por lo que tan pronto como su bot se detiene, todos los datos se pierden. Esto es conveniente cuando desarrollas tu bot o si ejecutas pruebas autom\xE1ticas (no se necesita configurar la base de datos), sin embargo, <strong>es muy probable que no se desee en producci\xF3n</strong>. En producci\xF3n, querr\xE1s persistir tus datos, por ejemplo en un archivo, una base de datos, o alg\xFAn otro almacenamiento.</p><p>Deber\xEDas utilizar la opci\xF3n <code>storage</code> del middleware de sesi\xF3n para conectarlo a tu almac\xE9n de datos. Puede que ya haya un adaptador de almacenamiento escrito para grammY que puedas utilizar (ver <a href="#adaptadores-de-almacenamiento-conocidos">abajo</a>, pero si no, normalmente s\xF3lo se necesitan 5 l\xEDneas de c\xF3digo para implementar uno t\xFA mismo.</p><h2 id="lazy-sessions" tabindex="-1"><a class="header-anchor" href="#lazy-sessions" aria-hidden="true">#</a> Lazy Sessions</h2><blockquote><p>Esta secci\xF3n describe una optimizaci\xF3n del rendimiento de la que la mayor\xEDa de la gente no tiene que preocuparse. Es posible que desee continuar con la secci\xF3n sobre <a href="#adaptadores-de-almacenamiento-conocidos">adaptadores de almacenamiento conocidos</a>.</p></blockquote><p>Las lazy sessions son una implementaci\xF3n alternativa de las sesiones que puede reducir significativamente el tr\xE1fico de la base de datos de tu bot al omitir operaciones de lectura y escritura superfluas.</p><p>Supongamos que tu bot est\xE1 en un chat de grupo en el que no responde a los mensajes de texto normales, sino s\xF3lo a los comandos. Sin sesiones, esto suceder\xEDa:</p><ol><li>Se env\xEDa una actualizaci\xF3n con un nuevo mensaje de texto a tu bot</li><li>No se invoca ning\xFAn manejador, por lo que no se realiza ninguna acci\xF3n</li><li>El middleware se completa inmediatamente</li></ol><p>En cuanto se instalan sesiones (por defecto, estrictas), que proporcionan directamente los datos de la sesi\xF3n en el objeto de contexto, sucede lo siguiente</p><ol><li>La actualizaci\xF3n con el nuevo mensaje de texto se env\xEDa a su bot</li><li>Los datos de la sesi\xF3n se cargan desde el almacenamiento de la sesi\xF3n (por ejemplo, la base de datos)</li><li>No se invoca ning\xFAn manejador, por lo que no se realiza ninguna acci\xF3n</li><li>Los datos id\xE9nticos de la sesi\xF3n se escriben de nuevo en el almacenamiento de la sesi\xF3n</li><li>El middleware se completa, y ha realizado una lectura y una escritura en el almacenamiento de datos</li></ol><p>Dependiendo de la naturaleza de tu bot, esto puede llevar a un mont\xF3n de lecturas y escrituras superfluas. Las sesiones perezosas te permiten saltarte los pasos 2. y 4. si resulta que ning\xFAn manejador invocado necesita datos de sesi\xF3n. En ese caso, no se leer\xE1 ning\xFAn dato del almac\xE9n de datos, ni se escribir\xE1 en \xE9l.</p><p>Esto se consigue interceptando el acceso a <code>ctx<wbr>.session</code>. Si no se invoca ning\xFAn gestor, nunca se acceder\xE1 a <code>ctx<wbr>.session</code>. Las sesiones perezosas utilizan esto como un indicador para evitar la comunicaci\xF3n con la base de datos.</p><p>En la pr\xE1ctica, en lugar de tener los datos de la sesi\xF3n disponibles en <code>ctx<wbr>.session</code>, ahora tendr\xE1 <em>una promesa de los datos de la sesi\xF3n</em> disponible en <code>ctx<wbr>.session</code>.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// Sesiones por defecto (sesiones estrictas)</span>
bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;settings&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \`session\` es el dato de la sesi\xF3n</span>
  <span class="token keyword">const</span> session <span class="token operator">=</span> ctx<span class="token punctuation">.</span>session<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Lazy sessions</span>
bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;settings&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// \`promise\` es una Promise de los datos de la sesi\xF3n, y</span>
  <span class="token keyword">const</span> promise <span class="token operator">=</span> ctx<span class="token punctuation">.</span>session<span class="token punctuation">;</span>
  <span class="token comment">// \`session\` es el dato de la sesi\xF3n</span>
  <span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>session<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Si nunca accedes a <code>ctx<wbr>.session</code>, no se realizar\xE1 ninguna operaci\xF3n, pero en cuanto accedas a la propiedad <code>session</code> del objeto contexto, se lanzar\xE1 la operaci\xF3n de lectura. Si nunca se lanza la lectura (o se asigna directamente un nuevo valor a <code>ctx<wbr>.session</code>), sabemos que tampoco necesitaremos escribir ning\xFAn dato de vuelta, porque no hay forma de que haya sido alterado. En consecuencia, nos saltamos tambi\xE9n la operaci\xF3n de escritura. Como resultado, conseguimos un m\xEDnimo de operaciones de lectura y escritura, pero puedes usar la sesi\xF3n casi id\xE9ntica a la anterior, s\xF3lo con unas pocas palabras clave <code>async</code> y <code>await</code> mezcladas en tu c\xF3digo.</p><p>Entonces, \xBFqu\xE9 es necesario para utilizar sesiones perezosas en lugar de las sesiones por defecto (estrictas)? Principalmente tienes que hacer tres cosas:</p><ol><li>Flavor tu contexto con <code>Lazy<wbr>Session<wbr>Flavor</code> en lugar de <code>Session<wbr>Flavor</code>. Funcionan de la misma manera, s\xF3lo que <code>ctx<wbr>.session</code> se envuelve dentro de una promesa para la variante perezosa.</li><li>Usa <code>lazy<wbr>Session</code> en lugar de <code>session</code> para registrar tu middleware de sesi\xF3n.</li><li>Pon siempre una promesa en l\xEDnea <code>await ctx<wbr>.session</code> en lugar de <code>ctx<wbr>.session</code> en todas las partes de tu middleware, tanto para lecturas como para escrituras. No te preocupes: puedes <code>await</code> la promesa con tus datos de sesi\xF3n tantas veces como quieras, pero siempre te referir\xE1s al mismo valor, as\xED que nunca habr\xE1 lecturas duplicadas para una actualizaci\xF3n.</li></ol><p>Ten en cuenta que con las sesiones lazy, puedes asignar tanto objetos como promesas de objetos a <code>ctx<wbr>.session</code>. Si estableces que <code>ctx<wbr>.session</code> sea una promesa, se <code>esperar\xE1</code> antes de escribir los datos de vuelta al almacenamiento de datos. Esto permitir\xEDa el siguiente c\xF3digo:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;reset&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Mucho m\xE1s corto que tener que \`esperar ctx.session\` primero:</span>
  ctx<span class="token punctuation">.</span>session <span class="token operator">=</span> ctx<span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>stats<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    stats<span class="token punctuation">.</span>counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Se puede argumentar bien que usar expl\xEDcitamente <code>await</code> es preferible a asignar una promesa a <code>ctx<wbr>.session</code>, la cuesti\xF3n es que <em>podr\xEDas</em> hacer esto si te gusta m\xE1s ese estilo por alguna raz\xF3n.</p><div class="custom-container tip"><p class="custom-container-title">Plugins que necesitan sesiones</p><p>Los desarrolladores de plugins que hacen uso de <code>ctx<wbr>.session</code> siempre deben permitir a los usuarios pasar <code>Session<wbr>Flavor | Lazy<wbr>Session<wbr>Flavor</code> y por lo tanto soportar ambos modos. En el c\xF3digo del plugin, simplemente espere <code>ctx<wbr>.session</code> todo el tiempo: si se pasa un objeto no prometido, \xE9ste simplemente se evaluar\xE1 a s\xED mismo, por lo que efectivamente s\xF3lo se escribe c\xF3digo para sesiones perezosas y as\xED se soportan sesiones estrictas autom\xE1ticamente.</p></div><h2 id="adaptadores-de-almacenamiento-conocidos" tabindex="-1"><a class="header-anchor" href="#adaptadores-de-almacenamiento-conocidos" aria-hidden="true">#</a> Adaptadores de almacenamiento conocidos</h2><p>Por defecto, las sesiones ser\xE1n almacenadas <a href="#ram-por-defecto">en su memoria</a> por el adaptador de almacenamiento incorporado. Tambi\xE9n puedes utilizar las sesiones persistentes que grammY <a href="#free-storage">ofrece gratuitamente</a>, o conectarte a <a href="#soluciones-de-almacenamiento-externo">almacenamientos externos</a>.</p><p>As\xED es como puedes instalar uno de los adaptadores de almacenamiento desde abajo.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> storageAdapter <span class="token operator">=</span> <span class="token operator">...</span> <span class="token comment">// depende de la configuraci\xF3n</span>

bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  initial<span class="token operator">:</span> <span class="token operator">...</span>
  storage<span class="token operator">:</span> storageAdapter<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ram-por-defecto" tabindex="-1"><a class="header-anchor" href="#ram-por-defecto" aria-hidden="true">#</a> RAM (por defecto)</h3><p>Por defecto, todos los datos se almacenan en la memoria RAM. Esto significa que todas las sesiones se pierden tan pronto como tu bot se detenga.</p>`,27),Z=s("Puedes usar la clase "),nn=n("code",null,[s("Memory"),n("wbr"),s("Session"),n("wbr"),s("Storage")],-1),sn=s(" ("),an={href:"https://doc.deno.land/https://deno.land/x/grammy/mod.ts/~/MemorySessionStorage",target:"_blank",rel:"noopener noreferrer"},en=s("API Reference"),tn=s(") del paquete central de grammY si quieres configurar m\xE1s cosas sobre el almacenamiento de datos en la RAM."),on=c(`<div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>bot<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  initial<span class="token operator">:</span> <span class="token operator">...</span>
  storage<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">MemorySessionStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// tambi\xE9n el valor por defecto</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="free-storage" tabindex="-1"><a class="header-anchor" href="#free-storage" aria-hidden="true">#</a> Free Storage</h3><blockquote><p>El almacenamiento gratuito est\xE1 pensado para ser utilizado en proyectos de aficionados. Las aplicaciones a escala de producci\xF3n deber\xEDan alojar su propia base de datos. La lista de integraciones soportadas de soluciones de almacenamiento externo est\xE1 <a href="#external-storage-solutions">aqu\xED abajo</a>.</p></blockquote>`,3),cn=s("Un beneficio de usar grammY es que obtienes acceso a almacenamiento gratuito en la nube. No requiere ninguna configuraci\xF3n - toda la autenticaci\xF3n se hace usando tu token de bot. \xA1Echa un vistazo a el "),ln={href:"https://github.com/grammyjs/storage-free",target:"_blank",rel:"noopener noreferrer"},pn=s("repositorio"),un=s("!"),rn=n("p",null,"Es muy f\xE1cil de usar:",-1),dn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" freeStorage "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"@grammyjs/storage-free"'),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  initial`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token operator"},"..."),s(`
  storage`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token generic-function"},[n("span",{class:"token function"},"freeStorage"),n("span",{class:"token generic class-name"},[n("span",{class:"token operator"},"<"),s("SessionData"),n("span",{class:"token operator"},">")])]),n("span",{class:"token punctuation"},"("),s("bot"),n("span",{class:"token punctuation"},"."),s("token"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),kn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" freeStorage "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"@grammyjs/storage-free"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  initial`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token operator"},"..."),s(`
  storage`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token function"},"freeStorage"),n("span",{class:"token punctuation"},"("),s("bot"),n("span",{class:"token punctuation"},"."),s("token"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),mn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" freeStorage "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"https://deno.land/x/grammy_storage/free/mod.ts"'),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  initial`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token operator"},"..."),s(`
  storage`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token generic-function"},[n("span",{class:"token function"},"freeStorage"),n("span",{class:"token generic class-name"},[n("span",{class:"token operator"},"<"),s("SessionData"),n("span",{class:"token operator"},">")])]),n("span",{class:"token punctuation"},"("),s("bot"),n("span",{class:"token punctuation"},"."),s("token"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),bn=n("p",null,"Ya est\xE1. Tu bot ahora utilizar\xE1 un almacenamiento de datos persistente.",-1),gn=n("p",null,"Aqu\xED hay un ejemplo de bot completo que puedes copiar para probarlo.",-1),hn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" Bot"),n("span",{class:"token punctuation"},","),s(" Context"),n("span",{class:"token punctuation"},","),s(" session"),n("span",{class:"token punctuation"},","),s(" SessionFlavor "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"grammy"'),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" freeStorage "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"@grammyjs/storage-free"'),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Definir la estructura de la sesi\xF3n."),s(`
`),n("span",{class:"token keyword"},"interface"),s(),n("span",{class:"token class-name"},"SessionData"),s(),n("span",{class:"token punctuation"},"{"),s(`
  count`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token builtin"},"number"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"MyContext"),s(),n("span",{class:"token operator"},"="),s(" Context "),n("span",{class:"token operator"},"&"),s(" SessionFlavor"),n("span",{class:"token operator"},"<"),s("SessionData"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Crear el bot y registrar el middleware de sesi\xF3n."),s(`
`),n("span",{class:"token keyword"},"const"),s(" bot "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},[s("Bot"),n("span",{class:"token operator"},"<"),s("MyContext"),n("span",{class:"token operator"},">")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(),n("span",{class:"token comment"},'// <-- pon tu token de bot entre los ""'),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token function-variable function"},"initial"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" count"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"0"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
  storage`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token generic-function"},[n("span",{class:"token function"},"freeStorage"),n("span",{class:"token generic class-name"},[n("span",{class:"token operator"},"<"),s("SessionData"),n("span",{class:"token operator"},">")])]),n("span",{class:"token punctuation"},"("),s("bot"),n("span",{class:"token punctuation"},"."),s("token"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Utilizar datos de sesi\xF3n persistentes en los manejadores de actualizaci\xF3n."),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"on"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"message"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("count"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"Message count: "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("ctx"),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("count"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"catch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),s("err"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token builtin"},"console"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"error"),n("span",{class:"token punctuation"},"("),s("err"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"start"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),vn=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" Bot"),n("span",{class:"token punctuation"},","),s(" session "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"grammy"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" freeStorage "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"@grammyjs/storage-free"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Crear el bot y registrar el middleware de sesi\xF3n."),s(`
`),n("span",{class:"token keyword"},"const"),s(" bot "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Bot"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(),n("span",{class:"token comment"},'// <-- pon tu token de bot entre los ""'),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token function-variable function"},"initial"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" count"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"0"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
  storage`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token function"},"freeStorage"),n("span",{class:"token punctuation"},"("),s("bot"),n("span",{class:"token punctuation"},"."),s("token"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Utilizar datos de sesi\xF3n persistentes en los manejadores de actualizaci\xF3n."),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"on"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"message"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("count"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"Message count: "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("ctx"),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("count"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"catch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),s("err"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token builtin"},"console"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"error"),n("span",{class:"token punctuation"},"("),s("err"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"start"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),_n=n("div",{class:"language-typescript ext-ts line-numbers-mode"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(`
  Bot`),n("span",{class:"token punctuation"},","),s(`
  Context`),n("span",{class:"token punctuation"},","),s(`
  session`),n("span",{class:"token punctuation"},","),s(`
  SessionFlavor`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"https://deno.land/x/grammy@v1.11.1/mod.ts"'),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" freeStorage "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},'"https://deno.land/x/grammy_storage/free/mod.ts"'),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Definir la estructura de la sesi\xF3n."),s(`
`),n("span",{class:"token keyword"},"interface"),s(),n("span",{class:"token class-name"},"SessionData"),s(),n("span",{class:"token punctuation"},"{"),s(`
  count`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token builtin"},"number"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"MyContext"),s(),n("span",{class:"token operator"},"="),s(" Context "),n("span",{class:"token operator"},"&"),s(" SessionFlavor"),n("span",{class:"token operator"},"<"),s("SessionData"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Crear el bot y registrar el middleware de sesi\xF3n."),s(`
`),n("span",{class:"token keyword"},"const"),s(" bot "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},[s("Bot"),n("span",{class:"token operator"},"<"),s("MyContext"),n("span",{class:"token operator"},">")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(),n("span",{class:"token comment"},'// <-- pon tu token de bot entre los ""'),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"session"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token function-variable function"},"initial"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" count"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"0"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
  storage`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token generic-function"},[n("span",{class:"token function"},"freeStorage"),n("span",{class:"token generic class-name"},[n("span",{class:"token operator"},"<"),s("SessionData"),n("span",{class:"token operator"},">")])]),n("span",{class:"token punctuation"},"("),s("bot"),n("span",{class:"token punctuation"},"."),s("token"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// Utilizar datos de sesi\xF3n persistentes en los manejadores de actualizaci\xF3n."),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"on"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"message"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("count"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"await"),s(" ctx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"reply"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"Message count: "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("ctx"),n("span",{class:"token punctuation"},"."),s("session"),n("span",{class:"token punctuation"},"."),s("count"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"catch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),s("err"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token builtin"},"console"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"error"),n("span",{class:"token punctuation"},"("),s("err"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
bot`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"start"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),fn=n("h3",{id:"soluciones-de-almacenamiento-externo",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#soluciones-de-almacenamiento-externo","aria-hidden":"true"},"#"),s(" Soluciones de almacenamiento externo")],-1),yn=n("p",null,"Mantenemos una lista de adaptadores de almacenamiento oficiales que le permiten almacenar sus datos de sesi\xF3n en diferentes lugares. Cada uno de ellos requerir\xE1 que te registres en un proveedor de alojamiento, o que alojes tu propia soluci\xF3n de almacenamiento.",-1),wn=s("Supabase: "),xn={href:"https://github.com/grammyjs/storage-supabase",target:"_blank",rel:"noopener noreferrer"},qn=s("https://"),jn=n("wbr",null,null,-1),zn=s("github"),Sn=n("wbr",null,null,-1),Cn=s(".com"),En=n("wbr",null,null,-1),Dn=s("/grammyjs"),Pn=n("wbr",null,null,-1),An=s("/storage"),Tn=n("wbr",null,null,-1),Ln=s("-supabase"),Mn=s("Deta.sh Base: "),Nn={href:"https://github.com/grammyjs/storage-deta",target:"_blank",rel:"noopener noreferrer"},Bn=s("https://"),Fn=n("wbr",null,null,-1),In=s("github"),Rn=n("wbr",null,null,-1),Yn=s(".com"),Kn=n("wbr",null,null,-1),$n=s("/grammyjs"),On=n("wbr",null,null,-1),Gn=s("/storage"),Un=n("wbr",null,null,-1),Jn=s("-deta"),Vn=s("Google Firestore (Node.js-only): "),Hn={href:"https://github.com/grammyjs/storage-firestore",target:"_blank",rel:"noopener noreferrer"},Qn=s("https://"),Wn=n("wbr",null,null,-1),Xn=s("github"),Zn=n("wbr",null,null,-1),ns=s(".com"),ss=n("wbr",null,null,-1),as=s("/grammyjs"),es=n("wbr",null,null,-1),ts=s("/storage"),os=n("wbr",null,null,-1),cs=s("-firestore"),is=s("Files: "),ls={href:"https://github.com/grammyjs/storages/tree/main/packages/file",target:"_blank",rel:"noopener noreferrer"},ps=s("https://"),us=n("wbr",null,null,-1),rs=s("github"),ds=n("wbr",null,null,-1),ks=s(".com"),ms=n("wbr",null,null,-1),bs=s("/grammyjs"),gs=n("wbr",null,null,-1),hs=s("/storages"),vs=n("wbr",null,null,-1),_s=s("/tree"),fs=n("wbr",null,null,-1),ys=s("/main"),ws=n("wbr",null,null,-1),xs=s("/packages"),qs=n("wbr",null,null,-1),js=s("/file"),zs=s("MongoDB: "),Ss={href:"https://github.com/grammyjs/storages/tree/main/packages/mongodb",target:"_blank",rel:"noopener noreferrer"},Cs=s("https://"),Es=n("wbr",null,null,-1),Ds=s("github"),Ps=n("wbr",null,null,-1),As=s(".com"),Ts=n("wbr",null,null,-1),Ls=s("/grammyjs"),Ms=n("wbr",null,null,-1),Ns=s("/storages"),Bs=n("wbr",null,null,-1),Fs=s("/tree"),Is=n("wbr",null,null,-1),Rs=s("/main"),Ys=n("wbr",null,null,-1),Ks=s("/packages"),$s=n("wbr",null,null,-1),Os=s("/mongodb"),Gs=s("Redis: "),Us={href:"https://github.com/grammyjs/storages/tree/main/packages/redis",target:"_blank",rel:"noopener noreferrer"},Js=s("https://"),Vs=n("wbr",null,null,-1),Hs=s("github"),Qs=n("wbr",null,null,-1),Ws=s(".com"),Xs=n("wbr",null,null,-1),Zs=s("/grammyjs"),na=n("wbr",null,null,-1),sa=s("/storages"),aa=n("wbr",null,null,-1),ea=s("/tree"),ta=n("wbr",null,null,-1),oa=s("/main"),ca=n("wbr",null,null,-1),ia=s("/packages"),la=n("wbr",null,null,-1),pa=s("/redis"),ua=s("PostgreSQL: "),ra={href:"https://github.com/grammyjs/storages/tree/main/packages/psql",target:"_blank",rel:"noopener noreferrer"},da=s("https://"),ka=n("wbr",null,null,-1),ma=s("github"),ba=n("wbr",null,null,-1),ga=s(".com"),ha=n("wbr",null,null,-1),va=s("/grammyjs"),_a=n("wbr",null,null,-1),fa=s("/storages"),ya=n("wbr",null,null,-1),wa=s("/tree"),xa=n("wbr",null,null,-1),qa=s("/main"),ja=n("wbr",null,null,-1),za=s("/packages"),Sa=n("wbr",null,null,-1),Ca=s("/psql"),Ea=s("TypeORM (solo para Node.js): "),Da={href:"https://github.com/grammyjs/storages/tree/main/packages/typeorm",target:"_blank",rel:"noopener noreferrer"},Pa=s("https://"),Aa=n("wbr",null,null,-1),Ta=s("github"),La=n("wbr",null,null,-1),Ma=s(".com"),Na=n("wbr",null,null,-1),Ba=s("/grammyjs"),Fa=n("wbr",null,null,-1),Ia=s("/storages"),Ra=n("wbr",null,null,-1),Ya=s("/tree"),Ka=n("wbr",null,null,-1),$a=s("/main"),Oa=n("wbr",null,null,-1),Ga=s("/packages"),Ua=n("wbr",null,null,-1),Ja=s("/typeorm"),Va=n("li",null,"DenoDB (solo para Deno): https://github.com/grammyjs/storages/tree/main/packages/denodb",-1),Ha=n("li",null,"Prisma (solo para Node.js): https://github.com/grammyjs/storages/tree/main/packages/prisma",-1),Qa={class:"custom-container tip"},Wa=n("p",{class:"custom-container-title"},"\xBFSu almacenamiento no es compatible? No hay problema.",-1),Xa=s("Crear un adaptador de almacenamiento personalizado es extremadamente sencillo. La opci\xF3n "),Za=n("code",null,"storage",-1),ne=s(" funciona con cualquier objeto que se adhiera a "),se={href:"https://doc.deno.land/https://deno.land/x/grammy/mod.ts/~/StorageAdapter",target:"_blank",rel:"noopener noreferrer"},ae=s("esta interfaz"),ee=s(", por lo que puedes conectarte a tu almacenamiento con s\xF3lo unas l\xEDneas de c\xF3digo."),te=n("blockquote",null,[n("p",null,"Si has publicado tu propio adaptador de almacenamiento, no dudes en editar esta p\xE1gina y enlazarla aqu\xED, para que otras personas puedan utilizarla.")],-1),oe=c('<p>Todos los adaptadores de almacenamiento pueden instalarse de la misma manera. En primer lugar, debes buscar el nombre del paquete del adaptador que hayas elegido. Por ejemplo, el adaptador de almacenamiento para Supabase se llama <code>supabase</code>.</p><p><strong>En Node.js</strong>, puedes instalar los adaptadores a trav\xE9s de <code>npm i @grammyjs<wbr>/storage<wbr>-&lt;nombre&gt;</code>. Por ejemplo, el adaptador de almacenamiento para Supabase puede instalarse mediante <code>npm i @grammyjs<wbr>/storage<wbr>-supabase</code>.</p><p><strong>En Deno</strong>, todos los adaptadores de almacenamiento se publican en el mismo m\xF3dulo de Deno. A continuaci\xF3n, puede importar el adaptador que necesite desde su sub-ruta en <code>https://<wbr>deno<wbr>.land<wbr>/x<wbr>/grammy<wbr>_storages<wbr>/&lt;adaptador&gt;<wbr>/src<wbr>/mod<wbr>.ts</code>. Por ejemplo, el adaptador de almacenamiento para Supabase puede importarse desde <code>https://<wbr>deno<wbr>.land<wbr>/x<wbr>/grammy<wbr>_storages<wbr>/supabase<wbr>/src<wbr>/mod<wbr>.ts</code>.</p><p>Consulta los repositorios respectivos sobre cada configuraci\xF3n individual. Contienen informaci\xF3n sobre c\xF3mo conectarlos a tu soluci\xF3n de almacenamiento.</p><h2 id="resumen-del-plugin" tabindex="-1"><a class="header-anchor" href="#resumen-del-plugin" aria-hidden="true">#</a> Resumen del plugin</h2><p>Este plugin est\xE1 incorporado en el n\xFAcleo de grammY. No necesitas instalar nada para usarlo. Simplemente importa todo desde el propio grammY.</p><p>Adem\xE1s, tanto la documentaci\xF3n como la referencia de la API de este plugin est\xE1n unificadas con el paquete del n\xFAcleo.</p>',7);function ce(ie,le){const u=i("AutotagPage"),t=i("ExternalLinkIcon"),o=i("CodeGroupItem"),l=i("CodeGroup"),p=i("RouterLink");return d(),k("div",null,[b,a(u,{config:'[{"url":["/plugins"],"exclude":["console-time","middlewares","autoquote","guide","session","keyboard","/"],"tag":[{"template":"official","text":"OFFICIAL","desc":"This plugin is published and maintained by grammY","locale":{"es":{"text":"OFICIAL","desc":"Este plugin es publicado y mantenido por grammY"},"id":{"text":"RESMI","desc":"Plugin ini dipublikasi dan dikelola oleh grammY"},"zh":{"text":"\u5B98\u65B9\u7EF4\u62A4","desc":"\u8FD9\u4E2A\u63D2\u4EF6\u662F\u7531grammY\u53D1\u5E03\u548C\u7EF4\u62A4\u7684"}}}]},{"url":["/plugins"],"include":["console-time","middlewares","autoquote"],"tag":[{"template":"thirdparty","text":"THIRD-PARTY","desc":"This plugin is maintained by third-party","locale":{"es":{"text":"DE TERCEROS","desc":"Este plugin es mantenido por terceros"},"id":{"text":"PIHAK KETIGA","desc":"Plugin ini dikelola oleh pihak ketiga"},"zh":{"text":"\u7B2C\u4E09\u65B9","desc":"\u8FD9\u4E2A\u63D2\u4EF6\u662F\u7531\u7B2C\u4E09\u65B9\u7EF4\u62A4\u7684"}}}]},{"url":["/hosting"],"exclude":["gcf","comparison"],"tag":[{"template":"deno","desc":"This setup is able to run Deno bots","locale":{"es":{"desc":"Esta configuraci\xF3n es capaz de ejecutar bots Deno"},"id":{"desc":"Konfigurasi ini dapat dijalankan di bot Deno"},"zh":{"desc":"\u8FD9\u4E2A\u8BBE\u7F6E\u80FD\u591F\u8FD0\u884CDeno\u673A\u5668\u4EBA"}}}]},{"url":["/hosting"],"include":["heroku","vps"],"tag":[{"template":"nodejs","desc":"This setup is able to run Node.js bots","locale":{"es":{"desc":"Esta configuraci\xF3n es capaz de ejecutar bots Node.js"},"id":{"desc":"Konfigurasi ini dapat dijalankan di bot Node.js"},"zh":{"desc":"\u8FD9\u4E2A\u8BBE\u7F6E\u80FD\u591F\u8FD0\u884CNode.js\u673A\u5668\u4EBA"}}}]}]'}),g,h,v,n("p",null,[_,n("a",f,[y,a(t)]),w]),x,a(l,null,{default:e(()=>[a(o,{title:"TypeScript",active:""},{default:e(()=>[q]),_:1}),a(o,{title:"JavaScript"},{default:e(()=>[j]),_:1}),a(o,{title:"Deno"},{default:e(()=>[z]),_:1})]),_:1}),n("p",null,[S,a(p,{to:"/es/guide/context.html#personalizaci%C3%B3n-del-objeto-de-contexto"},{default:e(()=>[C]),_:1}),E,D,P]),A,n("p",null,[T,L,M,n("a",N,[B,a(t)]),F,I,R]),a(l,null,{default:e(()=>[a(o,{title:"TypeScript",active:""},{default:e(()=>[Y]),_:1}),a(o,{title:"JavaScript"},{default:e(()=>[K]),_:1})]),_:1}),$,n("div",O,[G,U,n("p",null,[J,a(p,{to:"/es/guide/deployment-types.html"},{default:e(()=>[V]),_:1}),H,a(p,{to:"/es/plugins/runner.html#sequential-processing-where-necessary"},{default:e(()=>[Q]),_:1}),W])]),X,n("p",null,[Z,nn,sn,n("a",an,[en,a(t)]),tn]),on,n("p",null,[cn,n("a",ln,[pn,a(t)]),un]),rn,a(l,null,{default:e(()=>[a(o,{title:"TypeScript",active:""},{default:e(()=>[dn]),_:1}),a(o,{title:"JavaScript"},{default:e(()=>[kn]),_:1}),a(o,{title:"Deno"},{default:e(()=>[mn]),_:1})]),_:1}),bn,gn,a(l,null,{default:e(()=>[a(o,{title:"TypeScript",active:""},{default:e(()=>[hn]),_:1}),a(o,{title:"JavaScript"},{default:e(()=>[vn]),_:1}),a(o,{title:"Deno"},{default:e(()=>[_n]),_:1})]),_:1}),fn,yn,n("ul",null,[n("li",null,[wn,n("a",xn,[qn,jn,zn,Sn,Cn,En,Dn,Pn,An,Tn,Ln,a(t)])]),n("li",null,[Mn,n("a",Nn,[Bn,Fn,In,Rn,Yn,Kn,$n,On,Gn,Un,Jn,a(t)])]),n("li",null,[Vn,n("a",Hn,[Qn,Wn,Xn,Zn,ns,ss,as,es,ts,os,cs,a(t)])]),n("li",null,[is,n("a",ls,[ps,us,rs,ds,ks,ms,bs,gs,hs,vs,_s,fs,ys,ws,xs,qs,js,a(t)])]),n("li",null,[zs,n("a",Ss,[Cs,Es,Ds,Ps,As,Ts,Ls,Ms,Ns,Bs,Fs,Is,Rs,Ys,Ks,$s,Os,a(t)])]),n("li",null,[Gs,n("a",Us,[Js,Vs,Hs,Qs,Ws,Xs,Zs,na,sa,aa,ea,ta,oa,ca,ia,la,pa,a(t)])]),n("li",null,[ua,n("a",ra,[da,ka,ma,ba,ga,ha,va,_a,fa,ya,wa,xa,qa,ja,za,Sa,Ca,a(t)])]),n("li",null,[Ea,n("a",Da,[Pa,Aa,Ta,La,Ma,Na,Ba,Fa,Ia,Ra,Ya,Ka,$a,Oa,Ga,Ua,Ja,a(t)])]),Va,Ha]),n("div",Qa,[Wa,n("p",null,[Xa,Za,ne,n("a",se,[ae,a(t)]),ee]),te]),oe])}const ue=r(m,[["render",ce],["__file","session.html.vue"]]);export{ue as default};
