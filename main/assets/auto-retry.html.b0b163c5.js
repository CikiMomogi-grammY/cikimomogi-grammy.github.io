import{_ as u,r as a,o as p,c as d,a as e,b as s,w as t,d as n,e as r}from"./app.cd079934.js";const m={},b=e("h1",{id:"reintentar-solicitudes-de-la-api-auto-retry",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#reintentar-solicitudes-de-la-api-auto-retry","aria-hidden":"true"},"#"),n(" Reintentar solicitudes de la API ("),e("code",null,[n("auto"),e("wbr"),n("-retry")]),n(")")],-1),_=n("Considera usar el "),k=n("plugin throttler"),h=n(" en su lugar."),g=n("Este plugin es una "),f=n("funci\xF3n transformadora de la API"),y=n(", lo que significa que le permite interceptar y modificar las peticiones HTTP salientes sobre la marcha. M\xE1s concretamente, este plugin detectar\xE1 autom\xE1ticamente si una petici\xF3n de la API falla con un valor "),v=e("code",null,[n("retry"),e("wbr"),n("_after")],-1),w=n(", es decir, debido a la limitaci\xF3n de velocidad. Entonces atrapar\xE1 el error, esperar\xE1 el per\xEDodo de tiempo especificado, y luego reintentar\xE1 la solicitud."),x=r('<div class="custom-container warning"><p class="custom-container-title">Sea amable con el servidor de la API del bot</p><p>Telegram proporciona generosamente informaci\xF3n sobre cu\xE1nto tiempo debe esperar tu bot antes de la siguiente solicitud. Usar el plugin <code>auto<wbr>-retry</code> permitir\xE1 a tu bot rendir mejor durante los picos de carga, ya que las peticiones no fallar\xE1n simplemente por el l\xEDmite de inundaci\xF3n. Sin embargo, <strong>auto-retry no deber\xEDa ser usado</strong> si quieres evitar golpear los l\xEDmites de velocidad de forma regular. Si regularmente cruzas el umbral de la cantidad de solicitudes que puedes realizar, Telegram puede tomar medidas como restringir o prohibir tu bot.</p></div><p>Puedes instalar este plugin en el objeto <code>bot<wbr>.api</code>:</p>',2),j=e("div",{class:"language-typescript ext-ts line-numbers-mode"},[e("pre",{class:"language-typescript"},[e("code",null,[e("span",{class:"token keyword"},"import"),n(),e("span",{class:"token punctuation"},"{"),n(" autoRetry "),e("span",{class:"token punctuation"},"}"),n(),e("span",{class:"token keyword"},"from"),n(),e("span",{class:"token string"},'"@grammyjs/auto-retry"'),e("span",{class:"token punctuation"},";"),n(`

`),e("span",{class:"token comment"},"// Usa el plugin."),n(`
bot`),e("span",{class:"token punctuation"},"."),n("api"),e("span",{class:"token punctuation"},"."),n("config"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"use"),e("span",{class:"token punctuation"},"("),e("span",{class:"token function"},"autoRetry"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),n(`
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),R=e("div",{class:"language-javascript ext-js line-numbers-mode"},[e("pre",{class:"language-javascript"},[e("code",null,[e("span",{class:"token keyword"},"const"),n(),e("span",{class:"token punctuation"},"{"),n(" autoRetry "),e("span",{class:"token punctuation"},"}"),n(),e("span",{class:"token operator"},"="),n(),e("span",{class:"token function"},"require"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},'"@grammyjs/auto-retry"'),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),n(`

`),e("span",{class:"token comment"},"// Usa el plugin."),n(`
bot`),e("span",{class:"token punctuation"},"."),n("api"),e("span",{class:"token punctuation"},"."),n("config"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"use"),e("span",{class:"token punctuation"},"("),e("span",{class:"token function"},"autoRetry"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),n(`
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),q=e("div",{class:"language-typescript ext-ts line-numbers-mode"},[e("pre",{class:"language-typescript"},[e("code",null,[e("span",{class:"token keyword"},"import"),n(),e("span",{class:"token punctuation"},"{"),n(" autoRetry "),e("span",{class:"token punctuation"},"}"),n(),e("span",{class:"token keyword"},"from"),n(),e("span",{class:"token string"},'"https://esm.sh/@grammyjs/auto-retry"'),e("span",{class:"token punctuation"},";"),n(`

`),e("span",{class:"token comment"},"// Usa el plugin."),n(`
bot`),e("span",{class:"token punctuation"},"."),n("api"),e("span",{class:"token punctuation"},"."),n("config"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"use"),e("span",{class:"token punctuation"},"("),e("span",{class:"token function"},"autoRetry"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),n(`
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),S=r(`<p>Si ahora llama, por ejemplo, a <code>send<wbr>Message</code> y se encuentra con un l\xEDmite de velocidad, parecer\xE1 que la petici\xF3n tarda un tiempo inusual. Bajo el cap\xF3, se est\xE1n realizando m\xFAltiples peticiones HTTP, con los retrasos apropiados entre ellas.</p><p>Puede pasar un objeto de opciones que especifique un n\xFAmero m\xE1ximo de reintentos (<code>max<wbr>Retry<wbr>Attempts</code>, por defecto: 3), o un umbral para un tiempo m\xE1ximo de espera (<code>max<wbr>Delay<wbr>Seconds</code>, por defecto: 1 hora).</p><p>Tan pronto como se agote el n\xFAmero m\xE1ximo de reintentos, los siguientes errores para la misma petici\xF3n no se volver\xE1n a intentar. En su lugar, se pasa el objeto de error de Telegram, fallando efectivamente la petici\xF3n con un [<code>Grammy<wbr>Error</code>] (/guide/errors.md#the-grammyerror-object).</p><p>De forma similar, si la petici\xF3n falla con <code>retry<wbr>_after</code> mayor que lo especificado por la opci\xF3n <code>max<wbr>Delay<wbr>Seconds</code>, la petici\xF3n fallar\xE1 inmediatamente.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token function">autoRetry</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  maxRetryAttempts<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// S\xF3lo se repiten las peticiones una vez</span>
  maxDelaySeconds<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// Falla inmediatamente si tenemos que esperar &gt;5 segundos</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="resumen-del-plugin" tabindex="-1"><a class="header-anchor" href="#resumen-del-plugin" aria-hidden="true">#</a> Resumen del plugin</h2>`,6),T=e("li",null,[n("Nombre: "),e("code",null,[n("auto"),e("wbr"),n("-retry")])],-1),I=n("Fuente: "),P={href:"https://github.com/grammyjs/auto-retry",target:"_blank",rel:"noopener noreferrer"},C=n("https://"),E=e("wbr",null,null,-1),A=n("github"),D=e("wbr",null,null,-1),G=n(".com"),N=e("wbr",null,null,-1),z=n("/grammyjs"),B=e("wbr",null,null,-1),L=n("/auto"),U=e("wbr",null,null,-1),V=n("-retry"),F=n("Reference: "),H={href:"https://doc.deno.land/https://raw.githubusercontent.com/grammyjs/auto-retry/main/src/index.ts",target:"_blank",rel:"noopener noreferrer"},M=r("https://<wbr>doc<wbr>.deno<wbr>.land<wbr>/https://<wbr>raw<wbr>.githubusercontent<wbr>.com<wbr>/grammyjs<wbr>/auto<wbr>-retry<wbr>/main<wbr>/src<wbr>/index<wbr>.ts",29);function J(K,O){const i=a("RouterLink"),o=a("CodeGroupItem"),l=a("CodeGroup"),c=a("ExternalLinkIcon");return p(),d("div",null,[b,e("blockquote",null,[e("p",null,[_,s(i,{to:"/es/plugins/transformer-throttler.html"},{default:t(()=>[k]),_:1}),h])]),e("p",null,[g,s(i,{to:"/es/advanced/transformers.html"},{default:t(()=>[f]),_:1}),y,v,w]),x,s(l,null,{default:t(()=>[s(o,{title:"TypeScript",active:""},{default:t(()=>[j]),_:1}),s(o,{title:"JavaScript"},{default:t(()=>[R]),_:1}),s(o,{title:"Deno"},{default:t(()=>[q]),_:1})]),_:1}),S,e("ul",null,[T,e("li",null,[I,e("a",P,[C,E,A,D,G,N,z,B,L,U,V,s(c)])]),e("li",null,[F,e("a",H,[M,s(c)])])])])}const W=u(m,[["render",J],["__file","auto-retry.html.vue"]]);export{W as default};
